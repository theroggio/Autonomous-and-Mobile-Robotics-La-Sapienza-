# Exercises from Chapter 11 

## Problem 11.1

First we think about the tricycle, it needs 4 generalized coordinates: x-position, y-position, angle wrt x axis of the chassis, angle of the steerable wheel wrt chassis orientation.

Then for each of the N trailers, we can establish the position of the center between the wheels from the x and y position of the chassis, knowing the orientation of the wheels wrt the orientation of the wheels / chassis of the tricycle. 

So for each one of the N trailers we just need the orientation coordinate. 

This means the final set of generalized coordinates is <img src="http://bit.ly/2VYODuU" align="center" border="0" alt="q= \begin{bmatrix}x & y & \phi & \theta_0 & ... & \theta_N \end{bmatrix} ^T" width="150" height="20" />.

## Problem 11.2

We can easily build the matrix for the Pfaffian constraints which is

<a href="https://www.codecogs.com/eqnedit.php?latex=A^T&space;=&space;\begin{bmatrix}&space;0.5(\sqrt{3}c_3&space;-s_3)&space;&&space;0.5(c_3&space;&plus;&space;\sqrt{3}s_3)&space;&&space;l&space;&&space;r&space;&&space;0&space;&&space;0\\&space;s_3&space;&&space;-c_3&space;&&space;l&space;&&space;0&space;&&space;r&space;&&space;0\\&space;-0.5(\sqrt{3}c_3&plus;s_3)&space;&&space;0.5(c_3&space;-&space;\sqrt{3}s_3)&space;&&space;l&space;&&space;0&space;&&space;0&space;&&space;r&space;\end{bmatrix}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?A^T&space;=&space;\begin{bmatrix}&space;0.5(\sqrt{3}c_3&space;-s_3)&space;&&space;0.5(c_3&space;&plus;&space;\sqrt{3}s_3)&space;&&space;l&space;&&space;r&space;&&space;0&space;&&space;0\\&space;s_3&space;&&space;-c_3&space;&&space;l&space;&&space;0&space;&&space;r&space;&&space;0\\&space;-0.5(\sqrt{3}c_3&plus;s_3)&space;&&space;0.5(c_3&space;-&space;\sqrt{3}s_3)&space;&&space;l&space;&&space;0&space;&&space;0&space;&&space;r&space;\end{bmatrix}" title="A^T = \begin{bmatrix} 0.5(\sqrt{3}c_3 -s_3) & 0.5(c_3 + \sqrt{3}s_3) & l & r & 0 & 0\\ s_3 & -c_3 & l & 0 & r & 0\\ -0.5(\sqrt{3}c_3+s_3) & 0.5(c_3 - \sqrt{3}s_3) & l & 0 & 0 & r \end{bmatrix}" /></a>

Now we do not consider the first two columns, which are very likely not integrable due to the presence of cosine and sine. Restricting ourselves to the situation where the center of the robot is not moving (first two velocities are zero) we can sum up the three rows and obtain:

<a href="https://www.codecogs.com/eqnedit.php?latex=3l\dot{q_3}&space;&plus;&space;r(\dot{q_4}&space;&plus;&space;\dot{q_5}&space;&plus;&space;\dot{q_6})&space;=&space;0" target="_blank"><img src="https://latex.codecogs.com/gif.latex?3l\dot{q_3}&space;&plus;&space;r(\dot{q_4}&space;&plus;&space;\dot{q_5}&space;&plus;&space;\dot{q_6})&space;=&space;0" title="3l\dot{q_3} + r(\dot{q_4} + \dot{q_5} + \dot{q_6}) = 0" /></a>

From here we can easily re-order the equation and prove together that the constraint is integrable (so the system is partially integrable) and that the orientation of the vehicle (q3) is a linear function of the rotational angles of the wheels.

<a href="https://www.codecogs.com/eqnedit.php?latex=\dot{q_3}&space;=&space;-&space;\frac{r}{3l}(\dot{q_4}&space;&plus;&space;\dot{q_5}&space;&plus;&space;\dot{q_6})" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\dot{q_3}&space;=&space;-&space;\frac{r}{3l}(\dot{q_4}&space;&plus;&space;\dot{q_5}&space;&plus;&space;\dot{q_6})" title="\dot{q_3} = - \frac{r}{3l}(\dot{q_4} + \dot{q_5} + \dot{q_6})" /></a>

<a href="https://www.codecogs.com/eqnedit.php?latex=q_3&space;=&space;-&space;\frac{r}{3l}(q_4&space;&plus;&space;q_5&space;&plus;&space;q_6)&space;&plus;&space;c" target="_blank"><img src="https://latex.codecogs.com/gif.latex?q_3&space;=&space;-&space;\frac{r}{3l}(q_4&space;&plus;&space;q_5&space;&plus;&space;q_6)&space;&plus;&space;c" title="q_3 = - \frac{r}{3l}(q_4 + q_5 + q_6) + c" /></a>

## Problem 11.3

We need to remember that every component of the time derivative of q can be wrriten as the summation of a product between g_i * u_i. 

Considering the integrability condition we can assume that the n-1 vectors of the vector field are in the form

<a href="https://www.codecogs.com/eqnedit.php?latex=\begin{pmatrix}&space;-\gamma(q)a_2(q)\\&space;\gamma(q)a_1(q)\\&space;0\\&space;...\\&space;0&space;\\&space;\end{pmatrix}&space;\begin{pmatrix}&space;-\gamma(q)a_3(q)\\&space;0\\&space;\gamma(q)a_1(q)\\&space;...\\&space;0&space;\\&space;\end{pmatrix}&space;\begin{pmatrix}&space;-\gamma(q)a_n(q)\\&space;0\\&space;0\\&space;...\\&space;\gamma(q)a_1(q)&space;\\&space;\end{pmatrix}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\begin{pmatrix}&space;-\gamma(q)a_2(q)\\&space;\gamma(q)a_1(q)\\&space;0\\&space;...\\&space;0&space;\\&space;\end{pmatrix}&space;\begin{pmatrix}&space;-\gamma(q)a_3(q)\\&space;0\\&space;\gamma(q)a_1(q)\\&space;...\\&space;0&space;\\&space;\end{pmatrix}&space;\begin{pmatrix}&space;-\gamma(q)a_n(q)\\&space;0\\&space;0\\&space;...\\&space;\gamma(q)a_1(q)&space;\\&space;\end{pmatrix}" title="\begin{pmatrix} -\gamma(q)a_2(q)\\ \gamma(q)a_1(q)\\ 0\\ ...\\ 0 \\ \end{pmatrix} \begin{pmatrix} -\gamma(q)a_3(q)\\ 0\\ \gamma(q)a_1(q)\\ ...\\ 0 \\ \end{pmatrix} \begin{pmatrix} -\gamma(q)a_n(q)\\ 0\\ 0\\ ...\\ \gamma(q)a_1(q) \\ \end{pmatrix}" /></a>

The involutiveness is true if any Lie Bracket between any couple of vectors can be expressed as linear combination of the input vectors as well. Usin the integrability condition is easy to prove that any possible Lie Bracket will respect that having only partial derivative of gamma multiplied by a_i. 

## Problem 11.4

Without a mathematical prove, it's an easy intuition to say that if the Pfaffian matrix does not depend on the generalized coordinates it means that for our purpose it's a constant matrix. This matrix multiply the generalized velocities and as we know the result is a set of linear equation in the generalized velocities. 

If the constraint does not depends on the generalized coordinates, we have just coefficients multiplying the generalized velocities and this is always integrable. 

## Problem 11.5

First of all we need to remember the kinematic model of the unicycle, which is 

<a href="https://www.codecogs.com/eqnedit.php?latex=\left\{\begin{matrix}&space;\dot{x}&space;=&space;v&space;cos(\theta)\\&space;\dot{y}&space;=&space;v&space;sin(\theta)\\&space;\dot{\theta}&space;=&space;w&space;\end{matrix}\right." target="_blank"><img src="https://latex.codecogs.com/gif.latex?\left\{\begin{matrix}&space;\dot{x}&space;=&space;v&space;cos(\theta)\\&space;\dot{y}&space;=&space;v&space;sin(\theta)\\&space;\dot{\theta}&space;=&space;w&space;\end{matrix}\right." title="\left\{\begin{matrix} \dot{x} = v cos(\theta)\\ \dot{y} = v sin(\theta)\\ \dot{\theta} = w \end{matrix}\right." /></a>

And we know that our input are **v** and **w**. We can compute now the Lie Bracket, because we already know the vectors of the vector field (just compute the A matrix from the above model and find its null space). 

<a href="https://www.codecogs.com/eqnedit.php?latex=[g_1,g_2]&space;=&space;\begin{pmatrix}&space;sin(\theta)\\&space;-cos(\theta)\\&space;0&space;\end{pmatrix}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?[g_1,g_2]&space;=&space;\begin{pmatrix}&space;sin(\theta)\\&space;-cos(\theta)\\&space;0&space;\end{pmatrix}" title="[g_1,g_2] = \begin{pmatrix} sin(\theta)\\ -cos(\theta)\\ 0 \end{pmatrix}" /></a>

Now we can think about the movememnt of the robot split into the four steps. For every step we have a set of input that is fixed for time = epsilon and from that we can reconstruct the increments or decrements of **q**.

<a href="https://www.codecogs.com/eqnedit.php?latex=\left\{\begin{matrix}&space;x(\epsilon)&space;=&space;x(0)&space;&plus;&space;\epsilon&space;cos(\theta(0))\\&space;y(\epsilon)&space;=&space;y(0)&space;&plus;&space;\epsilon&space;sin(\theta(0))\\&space;\theta(\epsilon)&space;=&space;\theta(0)&space;\end{matrix}\right." target="_blank"><img src="https://latex.codecogs.com/gif.latex?\left\{\begin{matrix}&space;x(\epsilon)&space;=&space;x(0)&space;&plus;&space;\epsilon&space;cos(\theta(0))\\&space;y(\epsilon)&space;=&space;y(0)&space;&plus;&space;\epsilon&space;sin(\theta(0))\\&space;\theta(\epsilon)&space;=&space;\theta(0)&space;\end{matrix}\right." title="\left\{\begin{matrix} x(\epsilon) = x(0) + \epsilon cos(\theta(0))\\ y(\epsilon) = y(0) + \epsilon sin(\theta(0))\\ \theta(\epsilon) = \theta(0) \end{matrix}\right." /></a>

<a href="https://www.codecogs.com/eqnedit.php?latex=\left\{\begin{matrix}&space;x(2\epsilon)&space;=&space;x(0)&space;&plus;&space;\epsilon&space;cos(\theta(0))\\&space;y(2\epsilon)&space;=&space;y(0)&space;&plus;&space;\epsilon&space;sin(\theta(0))\\&space;\theta(2\epsilon)&space;=&space;\theta(0)&space;&plus;&space;\epsilon&space;\end{matrix}\right." target="_blank"><img src="https://latex.codecogs.com/gif.latex?\left\{\begin{matrix}&space;x(2\epsilon)&space;=&space;x(0)&space;&plus;&space;\epsilon&space;cos(\theta(0))\\&space;y(2\epsilon)&space;=&space;y(0)&space;&plus;&space;\epsilon&space;sin(\theta(0))\\&space;\theta(2\epsilon)&space;=&space;\theta(0)&space;&plus;&space;\epsilon&space;\end{matrix}\right." title="\left\{\begin{matrix} x(2\epsilon) = x(0) + \epsilon cos(\theta(0))\\ y(2\epsilon) = y(0) + \epsilon sin(\theta(0))\\ \theta(2\epsilon) = \theta(0) + \epsilon \end{matrix}\right." /></a>

<a href="https://www.codecogs.com/eqnedit.php?latex=\left\{\begin{matrix}&space;x(3\epsilon)&space;=&space;x(0)&space;&plus;&space;\epsilon&space;cos(\theta(0))&space;-&space;\epsilon&space;cos(\theta(0)&space;&plus;&space;\epsilon)\\&space;y(3\epsilon)&space;=&space;y(0)&space;&plus;&space;\epsilon&space;sin(\theta(0))&space;-&space;\epsilon&space;sin(\theta(0)&space;&plus;&space;\epsilon)\\&space;\theta(3\epsilon)&space;=&space;\theta(0)&space;&plus;&space;\epsilon&space;\end{matrix}\right." target="_blank"><img src="https://latex.codecogs.com/gif.latex?\left\{\begin{matrix}&space;x(3\epsilon)&space;=&space;x(0)&space;&plus;&space;\epsilon&space;cos(\theta(0))&space;-&space;\epsilon&space;cos(\theta(0)&space;&plus;&space;\epsilon)\\&space;y(3\epsilon)&space;=&space;y(0)&space;&plus;&space;\epsilon&space;sin(\theta(0))&space;-&space;\epsilon&space;sin(\theta(0)&space;&plus;&space;\epsilon)\\&space;\theta(3\epsilon)&space;=&space;\theta(0)&space;&plus;&space;\epsilon&space;\end{matrix}\right." title="\left\{\begin{matrix} x(3\epsilon) = x(0) + \epsilon cos(\theta(0)) - \epsilon cos(\theta(0) + \epsilon)\\ y(3\epsilon) = y(0) + \epsilon sin(\theta(0)) - \epsilon sin(\theta(0) + \epsilon)\\ \theta(3\epsilon) = \theta(0) + \epsilon \end{matrix}\right." /></a>

<a href="https://www.codecogs.com/eqnedit.php?latex=\left\{\begin{matrix}&space;x(4\epsilon)&space;=&space;x(0)&space;&plus;&space;\epsilon&space;cos(\theta(0))&space;-&space;\epsilon&space;cos(\theta(0)&space;&plus;&space;\epsilon)\\&space;y(4\epsilon)&space;=&space;y(0)&space;&plus;&space;\epsilon&space;sin(\theta(0))&space;-&space;\epsilon&space;sin(\theta(0)&space;&plus;&space;\epsilon)\\&space;\theta(4\epsilon)&space;=&space;\theta(0)&space;&plus;&space;\epsilon&space;-&space;\epsilon&space;\end{matrix}\right." target="_blank"><img src="https://latex.codecogs.com/gif.latex?\left\{\begin{matrix}&space;x(4\epsilon)&space;=&space;x(0)&space;&plus;&space;\epsilon&space;cos(\theta(0))&space;-&space;\epsilon&space;cos(\theta(0)&space;&plus;&space;\epsilon)\\&space;y(4\epsilon)&space;=&space;y(0)&space;&plus;&space;\epsilon&space;sin(\theta(0))&space;-&space;\epsilon&space;sin(\theta(0)&space;&plus;&space;\epsilon)\\&space;\theta(4\epsilon)&space;=&space;\theta(0)&space;&plus;&space;\epsilon&space;-&space;\epsilon&space;\end{matrix}\right." title="\left\{\begin{matrix} x(4\epsilon) = x(0) + \epsilon cos(\theta(0)) - \epsilon cos(\theta(0) + \epsilon)\\ y(4\epsilon) = y(0) + \epsilon sin(\theta(0)) - \epsilon sin(\theta(0) + \epsilon)\\ \theta(4\epsilon) = \theta(0) + \epsilon - \epsilon \end{matrix}\right." /></a>

For readability we can use the formulas for cosine and sine addiction to decompose the terms in the equation of x and y. Then for epsilon very small, its sine is exactly epsilon while its cosine is 1. Doing this substitution we find.

<a href="https://www.codecogs.com/eqnedit.php?latex=\left\{\begin{matrix}&space;x(4\epsilon)&space;=&space;x(0)&space;&plus;&space;\epsilon^2&space;sin(\theta(0))&space;\\&space;y(4\epsilon)&space;=&space;y(0)&space;-&space;\epsilon^2&space;cos(\theta(0))&space;\\&space;\theta(4\epsilon)&space;=&space;\theta(0)&space;\end{matrix}\right." target="_blank"><img src="https://latex.codecogs.com/gif.latex?\left\{\begin{matrix}&space;x(4\epsilon)&space;=&space;x(0)&space;&plus;&space;\epsilon^2&space;sin(\theta(0))&space;\\&space;y(4\epsilon)&space;=&space;y(0)&space;-&space;\epsilon^2&space;cos(\theta(0))&space;\\&space;\theta(4\epsilon)&space;=&space;\theta(0)&space;\end{matrix}\right." title="\left\{\begin{matrix} x(4\epsilon) = x(0) + \epsilon^2 sin(\theta(0)) \\ y(4\epsilon) = y(0) - \epsilon^2 cos(\theta(0)) \\ \theta(4\epsilon) = \theta(0) \end{matrix}\right." /></a>

So the total net displacement, which is obtained subtracting the configuration at time zero is:

<a href="https://www.codecogs.com/eqnedit.php?latex=\epsilon^2\begin{pmatrix}&space;sin(\theta(0))\\&space;-cos(\theta(0))\\&space;0&space;\end{pmatrix}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\epsilon^2\begin{pmatrix}&space;sin(\theta(0))\\&space;-cos(\theta(0))\\&space;0&space;\end{pmatrix}" title="\epsilon^2\begin{pmatrix} sin(\theta(0))\\ -cos(\theta(0))\\ 0 \end{pmatrix}" /></a>

Which is an infinitesimal movement in the direction of the Lie Bracket. 

## Problem 11.6

If we have a differential drive, it means we have two set of (x,y) coordinates for the positions of the two wheels and their derivate wrt time can be written as

<a href="https://www.codecogs.com/eqnedit.php?latex=\begin{pmatrix}&space;\dot{x_i}&space;=&space;rw_icos(\theta)\\&space;\dot{y_i}&space;=&space;rw_isin(\theta)&space;\end{pmatrix}&space;i&space;=&space;R,L" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\begin{pmatrix}&space;\dot{x_i}&space;=&space;rw_icos(\theta)\\&space;\dot{y_i}&space;=&space;rw_isin(\theta)&space;\end{pmatrix}&space;i&space;=&space;R,L" title="\begin{pmatrix} \dot{x_i} = rw_icos(\theta)\\ \dot{y_i} = rw_isin(\theta) \end{pmatrix} i = R,L" /></a>

Now the speed of the center between the two wheels is just an average 

<a href="https://www.codecogs.com/eqnedit.php?latex=v_i&space;=&space;\sqrt(\dot{x_i}^2&space;&plus;&space;\dot{y_i}^2)&space;=&space;\sqrt(r^2w_i^2cos^2(\theta)&space;&plus;&space;r^2w_i^2sin^2(\theta))&space;=&space;rw_i" target="_blank"><img src="https://latex.codecogs.com/gif.latex?v_i&space;=&space;\sqrt(\dot{x_i}^2&space;&plus;&space;\dot{y_i}^2)&space;=&space;\sqrt(r^2w_i^2cos^2(\theta)&space;&plus;&space;r^2w_i^2sin^2(\theta))&space;=&space;rw_i" title="v_i = \sqrt(\dot{x_i}^2 + \dot{y_i}^2) = \sqrt(r^2w_i^2cos^2(\theta) + r^2w_i^2sin^2(\theta)) = rw_i" /></a>

<a href="https://www.codecogs.com/eqnedit.php?latex=v_M&space;=&space;\frac{v_R&space;&plus;&space;v_L}{2}&space;=&space;\frac{r}{2}(w_R&space;&plus;&space;w_L))" target="_blank"><img src="https://latex.codecogs.com/gif.latex?v_M&space;=&space;\frac{v_R&space;&plus;&space;v_L}{2}&space;=&space;\frac{r}{2}(w_R&space;&plus;&space;w_L))" title="v_M = \frac{v_R + v_L}{2} = \frac{r}{2}(w_R + w_L))" /></a>

For the angular velocity we use the velocity composition rule which says that

<a href="https://www.codecogs.com/eqnedit.php?latex=\dot{p_R}&space;=&space;\dot{p_L}&space;&plus;&space;S(w)(p_r&space;-&space;p_L)" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\dot{p_R}&space;=&space;\dot{p_L}&space;&plus;&space;S(w)(p_r&space;-&space;p_L)" title="\dot{p_R} = \dot{p_L} + S(w)(p_r - p_L)" /></a>

where S(w) is a skew symmetric matrix. The difference between the positions of the two wheels can be easily computed in dependence of the distance between them and the orientation of the robot. The velocities are the ones above from which we computed the velocity of the 'unicycle'. 

Squaring and summing the terms of the equations we obtain a second grade equation in **w** with result 

<a href="https://www.codecogs.com/eqnedit.php?latex=w=&space;\frac{r}{d}(w_R&space;-&space;w_L)" target="_blank"><img src="https://latex.codecogs.com/gif.latex?w=&space;\frac{r}{d}(w_R&space;-&space;w_L)" title="w= \frac{r}{d}(w_R - w_L)" /></a>

## Problem 11.7

The first thing required is to compute the position of the center of rotation of the robot. To make it simpler let's consider a moving frame whose center is the midpoint of the rear wheels and whose axes are the onde indicating the orientation of the robot and the no-motion line for the rear wheels.

In this frame the **center of roation** is on one of the axis, so the other component is zero. The component > 0 can be computed using some geometry property building the triangle (with a 90° angle) with the no motion lines from the wheels and the rear wheel axis. Attention, this create a triangle whose sides are along the axis of the 'moving frame'. With the congruency theorem we can find the angles of the triangle and use the triangle rectus formulas to write that the side (midpoint of rear wheels to center of rotation) is l / tg(phi).

Now, we want to put all of this in the reference frame so we need to translate with respect to the midpoint of the rear wheels and to rotate back from the theta angle.

<a href="https://www.codecogs.com/eqnedit.php?latex=\begin{pmatrix}&space;x_c\\&space;y_c&space;\end{pmatrix}&space;=&space;\begin{pmatrix}&space;x\\&space;y&space;\end{pmatrix}&space;&plus;&space;R(\theta)&space;\begin{pmatrix}&space;0&space;\\&space;l&space;/&space;tg(\phi)\end{pmatrix}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\begin{pmatrix}&space;x_c\\&space;y_c&space;\end{pmatrix}&space;=&space;\begin{pmatrix}&space;x\\&space;y&space;\end{pmatrix}&space;&plus;&space;R(\theta)&space;\begin{pmatrix}&space;0&space;\\&space;l&space;/&space;tg(\phi)\end{pmatrix}" title="\begin{pmatrix} x_c\\ y_c \end{pmatrix} = \begin{pmatrix} x\\ y \end{pmatrix} + R(\theta) \begin{pmatrix} 0 \\ l / tg(\phi)\end{pmatrix}" /></a>

The angular velocity of any generic point P on the body can be computed as w = vp / Rp where vp is the velocity of that point and Rp is the radius of the trajectory, so to say.

The radius of the trajectory in our case is the distance between the center of rotation and the midpoint of the rear wheels that we'be just computed above. So we find that w = v * tg(phi) / l which is exactly what we have in the kinematic model of the bicycle. 

Then the velocity of the point v we can plug in the w just found in the relation w = vp / Rp. 

## Problem 11.8

First we compute the generalized coordinates and we write its constraints

<a href="https://www.codecogs.com/eqnedit.php?latex=\inline&space;q&space;=&space;\begin{bmatrix}&space;x&space;&&space;y&space;&&space;\phi&space;&&space;\theta_0&space;&&space;...&space;&&space;\theta_N&space;\end{bmatrix}&space;^T&space;\\&space;\\&space;\left\{\begin{matrix}&space;\dot{x_f}sen(\phi&space;&plus;&space;\theta_0)&space;-&space;\dot{y_f}cos(\phi&space;&plus;&space;\theta_0)&space;=&space;0\\&space;\dot{x}sen(\theta_0)&space;-&space;\dot{y}cos(\theta_0)&space;=&space;0&space;\\&space;\dot{x_i}sen(\theta_i)&space;-&space;\dot{y_i}cos(\theta_i)&space;=&space;0&space;\hspace{0.5cm}&space;\forall&space;i=&space;1,..,N&space;\\&space;\\&space;\end{matrix}\right." target="_blank"><img src="https://latex.codecogs.com/png.latex?\inline&space;q&space;=&space;\begin{bmatrix}&space;x&space;&&space;y&space;&&space;\phi&space;&&space;\theta_0&space;&&space;...&space;&&space;\theta_N&space;\end{bmatrix}&space;^T&space;\\&space;\\&space;\left\{\begin{matrix}&space;\dot{x_f}sen(\phi&space;&plus;&space;\theta_0)&space;-&space;\dot{y_f}cos(\phi&space;&plus;&space;\theta_0)&space;=&space;0\\&space;\dot{x}sen(\theta_0)&space;-&space;\dot{y}cos(\theta_0)&space;=&space;0&space;\\&space;\dot{x_i}sen(\theta_i)&space;-&space;\dot{y_i}cos(\theta_i)&space;=&space;0&space;\hspace{0.5cm}&space;\forall&space;i=&space;1,..,N&space;\\&space;\\&space;\end{matrix}\right." title="q = \begin{bmatrix} x & y & \phi & \theta_0 & ... & \theta_N \end{bmatrix} ^T \\ \\ \left\{\begin{matrix} \dot{x_f}sen(\phi + \theta_0) - \dot{y_f}cos(\phi + \theta_0) = 0\\ \dot{x}sen(\theta_0) - \dot{y}cos(\theta_0) = 0 \\ \dot{x_i}sen(\theta_i) - \dot{y_i}cos(\theta_i) = 0 \hspace{0.5cm} \forall i= 1,..,N \\ \\ \end{matrix}\right." /></a>

Being the pedice f used to indicate the fron wheel position we can compute its position wrt the rear wheels (depends on **l** and **theta0**.

For all the other positions we can generalize as

<a href="https://www.codecogs.com/eqnedit.php?latex=\inline&space;\begin{pmatrix}&space;x_i\\&space;y_1&space;\end{pmatrix}&space;=&space;\begin{pmatrix}&space;x&space;\\&space;y&space;\end{pmatrix}&space;-&space;\begin{pmatrix}&space;\sum_{j&space;=&space;1}^i&space;l_j&space;cos(\theta_j)&space;\\&space;\sum_{j&space;=&space;1}^i&space;l_j&space;sin(\theta_j)&space;\end{pmatrix}" target="_blank"><img src="https://latex.codecogs.com/png.latex?\inline&space;\begin{pmatrix}&space;x_i\\&space;y_1&space;\end{pmatrix}&space;=&space;\begin{pmatrix}&space;x&space;\\&space;y&space;\end{pmatrix}&space;-&space;\begin{pmatrix}&space;\sum_{j&space;=&space;1}^i&space;l_j&space;cos(\theta_j)&space;\\&space;\sum_{j&space;=&space;1}^i&space;l_j&space;sin(\theta_j)&space;\end{pmatrix}" title="\begin{pmatrix} x_i\\ y_1 \end{pmatrix} = \begin{pmatrix} x \\ y \end{pmatrix} - \begin{pmatrix} \sum_{j = 1}^i l_j cos(\theta_j) \\ \sum_{j = 1}^i l_j sin(\theta_j) \end{pmatrix}" /></a>

Which we can derive easily. This is due to the fact that we move back from the point we know (x,y) using the angle and the length of the connector link. 

Knowing these relationships we can rewrite the constraints as only dependent from the generalized cordinates and their derivates. In particular the N constraints for the trailers become

<a href="https://www.codecogs.com/eqnedit.php?latex=\inline&space;\dot{x}&space;sen(\theta_i)&space;-&space;\dot{y}&space;cos(\theta_i)&space;&plus;&space;\sum_{j=1}^i&space;l_j&space;cos(\theta_i&space;-&space;\theta_j)&space;=&space;0" target="_blank"><img src="https://latex.codecogs.com/png.latex?\inline&space;\dot{x}&space;sen(\theta_i)&space;-&space;\dot{y}&space;cos(\theta_i)&space;&plus;&space;\sum_{j=1}^i&space;l_j&space;cos(\theta_i&space;-&space;\theta_j)&space;=&space;0" title="\dot{x} sen(\theta_i) - \dot{y} cos(\theta_i) + \sum_{j=1}^i l_j cos(\theta_i - \theta_j) = 0" /></a>

Now we can expand the vectors of the vector field (the ones we know from the model without trailers) considering the trailers. The second vector which was ( 0 0 1 ) is augmented with a trailer of zeros because the input in steering velocity affect only **phi**.  The first vector has from the fourth component to the last one an element which can be formalized as

<a href="https://www.codecogs.com/eqnedit.php?latex=\inline&space;-\frac{1}{l_i}&space;(\prod_{j=1}^{i-1}&space;cos(\theta_j&space;-&space;\theta_{j-1}))sen(\theta_i&space;-&space;\theta_{i-1})" target="_blank"><img src="https://latex.codecogs.com/png.latex?\inline&space;-\frac{1}{l_i}&space;(\prod_{j=1}^{i-1}&space;cos(\theta_j&space;-&space;\theta_{j-1}))sen(\theta_i&space;-&space;\theta_{i-1})" title="-\frac{1}{l_i} (\prod_{j=1}^{i-1} cos(\theta_j - \theta_{j-1}))sen(\theta_i - \theta_{i-1})" /></a>

## Problem 11.9

Knowing the relationships between the angular velocities of the wheels and the canonical inputs - traction and steering velocity - we can use the substitution method as to solve the system and check the new constraints on these velocities. 

<a href="https://www.codecogs.com/eqnedit.php?latex=\inline&space;v&space;=&space;\frac{r}{2}(w_R&space;&plus;&space;w_L)&space;\hspace{0.5cm}&space;w&space;=&space;\frac{r}{d}(w_R&space;-&space;w_L)&space;\\&space;\\&space;\begin{Bmatrix}&space;\frac{2v}{r}&space;=&space;w_R&space;&plus;&space;w_L&space;\rightarrow^1&space;w_R&space;=&space;\frac{2v}{r}&space;-&space;w_L&space;\rightarrow^3&space;w_R&space;=&space;\frac{2v&plus;dw}{2r}&space;\\&space;w&space;=&space;\frac{r}{d}(\frac{2v}{r}&space;-&space;w_L)&space;\rightarrow^2&space;w_L&space;=&space;\frac{2v&space;-&space;dw}{2r}&space;\end{Bmatrix}" target="_blank"><img src="https://latex.codecogs.com/png.latex?\inline&space;v&space;=&space;\frac{r}{2}(w_R&space;&plus;&space;w_L)&space;\hspace{0.5cm}&space;w&space;=&space;\frac{r}{d}(w_R&space;-&space;w_L)&space;\\&space;\\&space;\begin{Bmatrix}&space;\frac{2v}{r}&space;=&space;w_R&space;&plus;&space;w_L&space;\rightarrow^1&space;w_R&space;=&space;\frac{2v}{r}&space;-&space;w_L&space;\rightarrow^3&space;w_R&space;=&space;\frac{2v&plus;dw}{2r}&space;\\&space;w&space;=&space;\frac{r}{d}(\frac{2v}{r}&space;-&space;w_L)&space;\rightarrow^2&space;w_L&space;=&space;\frac{2v&space;-&space;dw}{2r}&space;\end{Bmatrix}" title="v = \frac{r}{2}(w_R + w_L) \hspace{0.5cm} w = \frac{r}{d}(w_R - w_L) \\ \\ \begin{Bmatrix} \frac{2v}{r} = w_R + w_L \rightarrow^1 w_R = \frac{2v}{r} - w_L \rightarrow^3 w_R = \frac{2v+dw}{2r} \\ w = \frac{r}{d}(\frac{2v}{r} - w_L) \rightarrow^2 w_L = \frac{2v - dw}{2r} \end{Bmatrix}" /></a>

So we can substitute in the constraints the new formulas for the two angular velocities that depends only on **v** and **w**. To prove that the results space is a rhombus we can just compute some points and plot them

<a href="https://www.codecogs.com/eqnedit.php?latex=\inline&space;w&space;=&space;0&space;\hspace{0.5cm}&space;\left&space;|&space;v&space;\right&space;|&space;\leq&space;r&space;w_{RL}&space;\\&space;\\&space;v&space;=&space;0&space;\hspace{0.5cm}&space;\left&space;|&space;w&space;\right|&space;\leq&space;\frac{2&space;r&space;w_{RL}}{d}&space;\\&space;\\&space;v&space;=&space;\frac{r&space;w_{RL}}{2}&space;\hspace{0.5cm}&space;\left&space;|&space;w&space;\right&space;|&space;\leq&space;\frac{r}{d}&space;w_{RL}" target="_blank"><img src="https://latex.codecogs.com/png.latex?\inline&space;w&space;=&space;0&space;\hspace{0.5cm}&space;\left&space;|&space;v&space;\right&space;|&space;\leq&space;r&space;w_{RL}&space;\\&space;\\&space;v&space;=&space;0&space;\hspace{0.5cm}&space;\left&space;|&space;w&space;\right|&space;\leq&space;\frac{2&space;r&space;w_{RL}}{d}&space;\\&space;\\&space;v&space;=&space;\frac{r&space;w_{RL}}{2}&space;\hspace{0.5cm}&space;\left&space;|&space;w&space;\right&space;|&space;\leq&space;\frac{r}{d}&space;w_{RL}" title="w = 0 \hspace{0.5cm} \left | v \right | \leq r w_{RL} \\ \\ v = 0 \hspace{0.5cm} \left | w \right| \leq \frac{2 r w_{RL}}{d} \\ \\ v = \frac{r w_{RL}}{2} \hspace{0.5cm} \left | w \right | \leq \frac{r}{d} w_{RL}" /></a>

## Problem 11.10

From the system of equations of the chain form (2,4) we just substitute the inputs with the generalized ones:

<a href="https://www.codecogs.com/eqnedit.php?latex=u_1&space;=&space;sgn(\Delta)&space;\hspace{0.5cm}&space;u_2&space;=&space;c_o&space;&plus;&space;c_1&space;s&space;&plus;&space;c_2&space;s^2" target="_blank"><img src="https://latex.codecogs.com/png.latex?u_1&space;=&space;sgn(\Delta)&space;\hspace{0.5cm}&space;u_2&space;=&space;c_o&space;&plus;&space;c_1&space;s&space;&plus;&space;c_2&space;s^2" title="u_1 = sgn(\Delta) \hspace{0.5cm} u_2 = c_o + c_1 s + c_2 s^2" /></a>

where **Delta** is the difference between the final and initial configuration of z1 (which we knows from the transformations and because we know the final and initial point of the planning). 

Now we need to integrate to find z2, z3 and z4. Becase each z_i depends on the previous one we must find z2 first, plug it inside the velocity of z3 and then integrate z3, and so on. 

<a href="https://www.codecogs.com/eqnedit.php?latex=z_2&space;=&space;k_2&space;&plus;&space;c_0&space;s&space;&plus;&space;c_1&space;\frac{s^2}{2}&space;&plus;&space;c_2&space;\frac{s^3}{3}&space;\\&space;\\&space;z_3&space;=&space;sgn(\Delta)(k_3&space;&plus;&space;k_2&space;s&space;&plus;&space;c_0&space;\frac{s^2}{2}&space;&plus;&space;c_1&space;\frac{s^3}{6}&space;&plus;&space;c_2&space;\frac{s^4}{12})&space;\\&space;\\&space;z_4&space;=&space;k_4&space;&plus;&space;k_3&space;s&space;&plus;&space;k_2&space;\frac{s^2}{2}&space;&plus;&space;c_0&space;\frac{s^3}{6}&space;&plus;&space;c_1&space;\frac{s^4}{24}&space;&plus;&space;c_2&space;\frac{s^5}{60}" target="_blank"><img src="https://latex.codecogs.com/png.latex?z_2&space;=&space;k_2&space;&plus;&space;c_0&space;s&space;&plus;&space;c_1&space;\frac{s^2}{2}&space;&plus;&space;c_2&space;\frac{s^3}{3}&space;\\&space;\\&space;z_3&space;=&space;sgn(\Delta)(k_3&space;&plus;&space;k_2&space;s&space;&plus;&space;c_0&space;\frac{s^2}{2}&space;&plus;&space;c_1&space;\frac{s^3}{6}&space;&plus;&space;c_2&space;\frac{s^4}{12})&space;\\&space;\\&space;z_4&space;=&space;k_4&space;&plus;&space;k_3&space;s&space;&plus;&space;k_2&space;\frac{s^2}{2}&space;&plus;&space;c_0&space;\frac{s^3}{6}&space;&plus;&space;c_1&space;\frac{s^4}{24}&space;&plus;&space;c_2&space;\frac{s^5}{60}" title="z_2 = k_2 + c_0 s + c_1 \frac{s^2}{2} + c_2 \frac{s^3}{3} \\ \\ z_3 = sgn(\Delta)(k_3 + k_2 s + c_0 \frac{s^2}{2} + c_1 \frac{s^3}{6} + c_2 \frac{s^4}{12}) \\ \\ z_4 = k_4 + k_3 s + k_2 \frac{s^2}{2} + c_0 \frac{s^3}{6} + c_1 \frac{s^4}{24} + c_2 \frac{s^5}{60}" /></a>

Now we need to impose the final position when we arrive at the final time. The final time is when z1 arrives to z1_f, because the diffenrece between them is **Delta** and the speed of z1 is 1 (or -1 if delta is negative), the final time is **s = Delta**. 

<a href="https://www.codecogs.com/eqnedit.php?latex=k_2&space;&plus;&space;c_0&space;\left&space;|&space;\Delta&space;\right&space;|&space;&plus;&space;c_1&space;\frac{\Delta^2}{2}&space;&plus;&space;c_2&space;\frac{\left&space;|&space;\Delta&space;\right|^3}{3}&space;=&space;z_{2,f}&space;\\&space;\\&space;k_3&space;&plus;&space;k_2&space;\Delta&space;&plus;&space;sgn(\Delta)&space;c_0&space;\frac{\Delta^2}{2}&space;&plus;&space;c_1&space;\frac{\Delta^3}{6}&space;&plus;&space;sgn(\Delta)c_2&space;\frac{\Delta^4}{12}&space;=&space;z_{3,f}&space;\\&space;\\&space;k_4&space;&plus;&space;k_3&space;\left&space;|&space;\Delta&space;\right&space;|&space;&plus;&space;k_2&space;\frac{\Delta^2}{2}&space;&plus;&space;c_0&space;\frac{\left&space;|&space;\Delta&space;\right&space;|^3}{6}&space;&plus;&space;c_1&space;\frac{\Delta^4}{24}&space;&plus;&space;c_2&space;\frac{\left&space;|&space;\Delta&space;\right&space;|^5}{60}&space;=&space;z_{4,f}" target="_blank"><img src="https://latex.codecogs.com/png.latex?k_2&space;&plus;&space;c_0&space;\left&space;|&space;\Delta&space;\right&space;|&space;&plus;&space;c_1&space;\frac{\Delta^2}{2}&space;&plus;&space;c_2&space;\frac{\left&space;|&space;\Delta&space;\right|^3}{3}&space;=&space;z_{2,f}&space;\\&space;\\&space;k_3&space;&plus;&space;k_2&space;\Delta&space;&plus;&space;sgn(\Delta)&space;c_0&space;\frac{\Delta^2}{2}&space;&plus;&space;c_1&space;\frac{\Delta^3}{6}&space;&plus;&space;sgn(\Delta)c_2&space;\frac{\Delta^4}{12}&space;=&space;z_{3,f}&space;\\&space;\\&space;k_4&space;&plus;&space;k_3&space;\left&space;|&space;\Delta&space;\right&space;|&space;&plus;&space;k_2&space;\frac{\Delta^2}{2}&space;&plus;&space;c_0&space;\frac{\left&space;|&space;\Delta&space;\right&space;|^3}{6}&space;&plus;&space;c_1&space;\frac{\Delta^4}{24}&space;&plus;&space;c_2&space;\frac{\left&space;|&space;\Delta&space;\right&space;|^5}{60}&space;=&space;z_{4,f}" title="k_2 + c_0 \left | \Delta \right | + c_1 \frac{\Delta^2}{2} + c_2 \frac{\left | \Delta \right|^3}{3} = z_{2,f} \\ \\ k_3 + k_2 \Delta + sgn(\Delta) c_0 \frac{\Delta^2}{2} + c_1 \frac{\Delta^3}{6} + sgn(\Delta)c_2 \frac{\Delta^4}{12} = z_{3,f} \\ \\ k_4 + k_3 \left | \Delta \right | + k_2 \frac{\Delta^2}{2} + c_0 \frac{\left | \Delta \right |^3}{6} + c_1 \frac{\Delta^4}{24} + c_2 \frac{\left | \Delta \right |^5}{60} = z_{4,f}" /></a>

Now we need to remove the k values, because they are 'ulterior' coefficients that we cannot use, we must use the minimal required number of coefficients. We can easily see from the formulas of the z's that the initial values of each one of them (when **s=0**) is exactly one of the coefficients, so we can use a linear combination of them to remove this extra part.

<a href="https://www.codecogs.com/eqnedit.php?latex=c_0&space;\left&space;|&space;\Delta&space;\right&space;|&space;&plus;&space;c_1&space;\frac{\Delta^2}{2}&space;&plus;&space;c_2&space;\frac{\left&space;|&space;\Delta&space;\right|^3}{3}&space;=&space;z_{2,f}&space;-z_{2,1}&space;\\&space;\\&space;sgn(\Delta)&space;c_0&space;\frac{\Delta^2}{2}&space;&plus;&space;c_1&space;\frac{\Delta^3}{6}&space;&plus;&space;sgn(\Delta)c_2&space;\frac{\Delta^4}{12}&space;=&space;z_{3,f}&space;-&space;z_{3,i}&space;-&space;z_{2,i}&space;\Delta&space;\\&space;\\&space;c_0&space;\frac{\left&space;|&space;\Delta&space;\right&space;|^3}{6}&space;&plus;&space;c_1&space;\frac{\Delta^4}{24}&space;&plus;&space;c_2&space;\frac{\left&space;|&space;\Delta&space;\right&space;|^5}{60}&space;=&space;z_{4,f}&space;-&space;z_{4,i}&space;-&space;z_{3,i}\left&space;|&space;\Delta&space;\right&space;|&space;-&space;z_{2,i}\frac{\Delta^2}{2}" target="_blank"><img src="https://latex.codecogs.com/png.latex?c_0&space;\left&space;|&space;\Delta&space;\right&space;|&space;&plus;&space;c_1&space;\frac{\Delta^2}{2}&space;&plus;&space;c_2&space;\frac{\left&space;|&space;\Delta&space;\right|^3}{3}&space;=&space;z_{2,f}&space;-z_{2,1}&space;\\&space;\\&space;sgn(\Delta)&space;c_0&space;\frac{\Delta^2}{2}&space;&plus;&space;c_1&space;\frac{\Delta^3}{6}&space;&plus;&space;sgn(\Delta)c_2&space;\frac{\Delta^4}{12}&space;=&space;z_{3,f}&space;-&space;z_{3,i}&space;-&space;z_{2,i}&space;\Delta&space;\\&space;\\&space;c_0&space;\frac{\left&space;|&space;\Delta&space;\right&space;|^3}{6}&space;&plus;&space;c_1&space;\frac{\Delta^4}{24}&space;&plus;&space;c_2&space;\frac{\left&space;|&space;\Delta&space;\right&space;|^5}{60}&space;=&space;z_{4,f}&space;-&space;z_{4,i}&space;-&space;z_{3,i}\left&space;|&space;\Delta&space;\right&space;|&space;-&space;z_{2,i}\frac{\Delta^2}{2}" title="c_0 \left | \Delta \right | + c_1 \frac{\Delta^2}{2} + c_2 \frac{\left | \Delta \right|^3}{3} = z_{2,f} -z_{2,1} \\ \\ sgn(\Delta) c_0 \frac{\Delta^2}{2} + c_1 \frac{\Delta^3}{6} + sgn(\Delta)c_2 \frac{\Delta^4}{12} = z_{3,f} - z_{3,i} - z_{2,i} \Delta \\ \\ c_0 \frac{\left | \Delta \right |^3}{6} + c_1 \frac{\Delta^4}{24} + c_2 \frac{\left | \Delta \right |^5}{60} = z_{4,f} - z_{4,i} - z_{3,i}\left | \Delta \right | - z_{2,i}\frac{\Delta^2}{2}" /></a>

So we have on the left the **d** vector, function of initial and final position and Delta. On the right we can see the system as a matrix **D** which multiplies a vector of the coefficients ( just c0, c1, c2) and it depends only on Delta. 

<a href="https://www.codecogs.com/eqnedit.php?latex=d&space;=&space;\begin{pmatrix}&space;z_{2,f}&space;-z_{2,1}&space;\\&space;z_{3,f}&space;-&space;z_{3,i}&space;-&space;z_{2,i}&space;\Delta&space;\\&space;z_{4,f}&space;-&space;z_{4,i}&space;-&space;z_{3,i}\left&space;|&space;\Delta&space;\right&space;|&space;-&space;z_{2,i}\frac{\Delta^2}{2}&space;\end{pmatrix}&space;\hspace{1cm}&space;D&space;=&space;\begin{pmatrix}&space;\left&space;|&space;\Delta&space;\right&space;|&space;&&space;\frac{\Delta^2}{2}&space;&&space;\frac{\left&space;|&space;\Delta&space;\right|^3}{3}&space;\\&space;sgn(\Delta)&space;\frac{\Delta^2}{2}&space;&&space;\frac{\Delta^3}{6}&space;&&space;sgn(\Delta)&space;\frac{\Delta^4}{12}&space;\\&space;\frac{\left&space;|&space;\Delta&space;\right&space;|^3}{6}&space;&&space;\frac{\Delta^4}{24}&space;&&space;\frac{\left&space;|&space;\Delta&space;\right&space;|^5}{60}&space;\end{pmatrix}" target="_blank"><img src="https://latex.codecogs.com/png.latex?d&space;=&space;\begin{pmatrix}&space;z_{2,f}&space;-z_{2,1}&space;\\&space;z_{3,f}&space;-&space;z_{3,i}&space;-&space;z_{2,i}&space;\Delta&space;\\&space;z_{4,f}&space;-&space;z_{4,i}&space;-&space;z_{3,i}\left&space;|&space;\Delta&space;\right&space;|&space;-&space;z_{2,i}\frac{\Delta^2}{2}&space;\end{pmatrix}&space;\hspace{1cm}&space;D&space;=&space;\begin{pmatrix}&space;\left&space;|&space;\Delta&space;\right&space;|&space;&&space;\frac{\Delta^2}{2}&space;&&space;\frac{\left&space;|&space;\Delta&space;\right|^3}{3}&space;\\&space;sgn(\Delta)&space;\frac{\Delta^2}{2}&space;&&space;\frac{\Delta^3}{6}&space;&&space;sgn(\Delta)&space;\frac{\Delta^4}{12}&space;\\&space;\frac{\left&space;|&space;\Delta&space;\right&space;|^3}{6}&space;&&space;\frac{\Delta^4}{24}&space;&&space;\frac{\left&space;|&space;\Delta&space;\right&space;|^5}{60}&space;\end{pmatrix}" title="d = \begin{pmatrix} z_{2,f} -z_{2,1} \\ z_{3,f} - z_{3,i} - z_{2,i} \Delta \\ z_{4,f} - z_{4,i} - z_{3,i}\left | \Delta \right | - z_{2,i}\frac{\Delta^2}{2} \end{pmatrix} \hspace{1cm} D = \begin{pmatrix} \left | \Delta \right | & \frac{\Delta^2}{2} & \frac{\left | \Delta \right|^3}{3} \\ sgn(\Delta) \frac{\Delta^2}{2} & \frac{\Delta^3}{6} & sgn(\Delta) \frac{\Delta^4}{12} \\ \frac{\left | \Delta \right |^3}{6} & \frac{\Delta^4}{24} & \frac{\left | \Delta \right |^5}{60} \end{pmatrix}" /></a>

## Problem 11.11

We know that the final value for the usual representation (see Problem 11.10) is Delta, which is also the difference between the final and the initial value of z1. If we want to scale the final value of s to be 1, we need the velocity to be delta times the velocity in the common model. 

The velocity is the sign of delta usually, which means +1 or -1 depending on its direction, we just need to put this velocity to Delta to have a final value at s = 1 (pay attention delta has its sign already, so we're covering both the possibilitis of +1 and -1).

## Problem 11.12

First of all the big difference between the two schemes is the final time, but as exposed on Problem 11.11 we can bring the final value of s in the scheme A (the one saw in Problem 11.10) to 1, equal to the final value of s in the scheme B (polynomials interpolated).

Hence in scheme A we have

<a href="https://www.codecogs.com/eqnedit.php?latex=\\&space;z_1(s)&space;=&space;z_{1,i}&space;&plus;&space;v_1&space;s&space;=&space;z_{1,i}&space;&plus;&space;(z_{1,f}&space;-&space;z_{1,i})s&space;\\&space;z_2(s)&space;=&space;z_{2,i}&space;&plus;&space;v_2&space;s&space;=&space;z_{2,i}&space;&plus;&space;c_0s&space;&plus;&space;c_1&space;\frac{s^2}{2}&space;\\&space;z_3(s)&space;=&space;\int&space;v_1&space;z_2(s)&space;=&space;z_{3,i}&space;&plus;&space;\Delta(z_{2,i}s&space;&plus;&space;c_0&space;\frac{s^2}{2}&space;&plus;&space;c_1&space;\frac{s^3}{6})&space;\hspace{0.8cm}&space;\Delta&space;constant_{integration}&space;=&space;z_{3,i}" target="_blank"><img src="https://latex.codecogs.com/png.latex?\\&space;z_1(s)&space;=&space;z_{1,i}&space;&plus;&space;v_1&space;s&space;=&space;z_{1,i}&space;&plus;&space;(z_{1,f}&space;-&space;z_{1,i})s&space;\\&space;z_2(s)&space;=&space;z_{2,i}&space;&plus;&space;v_2&space;s&space;=&space;z_{2,i}&space;&plus;&space;c_0s&space;&plus;&space;c_1&space;\frac{s^2}{2}&space;\\&space;z_3(s)&space;=&space;\int&space;v_1&space;z_2(s)&space;=&space;z_{3,i}&space;&plus;&space;\Delta(z_{2,i}s&space;&plus;&space;c_0&space;\frac{s^2}{2}&space;&plus;&space;c_1&space;\frac{s^3}{6})&space;\hspace{0.8cm}&space;\Delta&space;constant_{integration}&space;=&space;z_{3,i}" title="\\ z_1(s) = z_{1,i} + v_1 s = z_{1,i} + (z_{1,f} - z_{1,i})s \\ z_2(s) = z_{2,i} + v_2 s = z_{2,i} + c_0s + c_1 \frac{s^2}{2} \\ z_3(s) = \int v_1 z_2(s) = z_{3,i} + \Delta(z_{2,i}s + c_0 \frac{s^2}{2} + c_1 \frac{s^3}{6}) \hspace{0.8cm} \Delta constant_{integration} = z_{3,i}" /></a>

First: we notice that here as in scheme B, z3 is a cubic polynomial. Having two conditions to satisfy for the polynomial, which are the derivate at time 0 and at time 1, we know that the polynomial is unique. This means that with the other scheme we'll get to the same cubic polynomia, with the same coefficients.

## Problem 11.13

The algorithm requires is just an assignment from the computations on the Book (11.5.3).

<a href="https://www.codecogs.com/eqnedit.php?latex=\\&space;\alpha_x&space;=&space;k_f&space;cos(\theta_f)&space;-&space;3x_f&space;\\&space;\alpha_y&space;=&space;k_f&space;sin(\theta_f)&space;-&space;3y_f&space;\\&space;\beta_x&space;=&space;k_i&space;cos(\theta_i)&space;&plus;&space;3x_i&space;\\&space;\beta_y&space;=&space;k_i&space;sin(\theta_i)&space;&plus;&space;3y_i" target="_blank"><img src="https://latex.codecogs.com/png.latex?\\&space;\alpha_x&space;=&space;k_f&space;cos(\theta_f)&space;-&space;3x_f&space;\\&space;\alpha_y&space;=&space;k_f&space;sin(\theta_f)&space;-&space;3y_f&space;\\&space;\beta_x&space;=&space;k_i&space;cos(\theta_i)&space;&plus;&space;3x_i&space;\\&space;\beta_y&space;=&space;k_i&space;sin(\theta_i)&space;&plus;&space;3y_i" title="\\ \alpha_x = k_f cos(\theta_f) - 3x_f \\ \alpha_y = k_f sin(\theta_f) - 3y_f \\ \beta_x = k_i cos(\theta_i) + 3x_i \\ \beta_y = k_i sin(\theta_i) + 3y_i" /></a>

To check the constraints we need to compute the function of v(s) and w(s) using the differential flatness property (knowing x and y we can reconstruct all the variables). If the constraints are violated we can use a uniform scaling with T = max{v,w}. 

In the specific case proposed these are the results:

<a href="https://www.codecogs.com/eqnedit.php?latex=\\&space;\alpha_x&space;=&space;-6&space;\\&space;\alpha_y&space;=&space;-2&space;\\&space;\beta_x&space;=&space;1&space;\\&space;\beta_y&space;=&space;0&space;\\&space;T&space;=&space;10" target="_blank"><img src="https://latex.codecogs.com/png.latex?\\&space;\alpha_x&space;=&space;-6&space;\\&space;\alpha_y&space;=&space;-2&space;\\&space;\beta_x&space;=&space;1&space;\\&space;\beta_y&space;=&space;0&space;\\&space;T&space;=&space;10" title="\\ \alpha_x = -6 \\ \alpha_y = -2 \\ \beta_x = 1 \\ \beta_y = 0 \\ T = 10" /></a>
